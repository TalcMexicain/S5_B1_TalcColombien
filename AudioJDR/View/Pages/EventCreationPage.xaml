<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:View.Resources.Localization"
             x:Class="View.EventCreationPage">
    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">

            <!-- Title Section -->
            <Label Text="{x:Static local:AppResources.TitleCreateNode}"
                   FontSize="24"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   Margin="0,10,0,20" />

            <!-- Node title input -->
            <Frame BorderColor="#cccccc" CornerRadius="10" Padding="10">
                <VerticalStackLayout>
                    <Label Text="{x:Static local:AppResources.NodeTitle}"
                           FontSize="Medium"
                           FontAttributes="Bold"
                           Margin="0,0,0,5" />
                    <Entry x:Name="NodeTitleEntry"
                           Placeholder="{x:Static local:AppResources.PlaceholderNodeTitle}"
                           FontSize="Medium" />
                </VerticalStackLayout>
            </Frame>

            <!-- Node content input -->
            <Frame BorderColor="#cccccc" CornerRadius="10" Padding="10">
                <VerticalStackLayout>
                    <Label Text="{x:Static local:AppResources.StoryContent}"
                           FontSize="Medium"
                           FontAttributes="Bold"
                           Margin="0,0,0,5" />
                    <Editor x:Name="NodeContentEditor"
                            Placeholder="{x:Static local:AppResources.PlaceholderStoryContent}"
                            HeightRequest="250"
                            FontSize="Medium" />
                </VerticalStackLayout>
            </Frame>

            <!-- Choices Section -->
            <Frame BorderColor="#cccccc" CornerRadius="10" Padding="10">
                <VerticalStackLayout>
                    <Label Text="{x:Static local:AppResources.Choices}"
                           FontSize="Medium"
                           FontAttributes="Bold"
                           Margin="0,0,0,10" />

                    <!-- Button to add a new choice -->
                    <Button Text="{x:Static local:AppResources.AddChoice}"
                            FontSize="Small"
                            BackgroundColor="#4CAF50"
                            TextColor="White"
                            CornerRadius="20"
                            HeightRequest="40"
                            WidthRequest="170"
                            HorizontalOptions="Start"
                            Padding="10"
                            Clicked="OnAddChoiceClicked" />

                    <!-- List of choices -->
                    <CollectionView x:Name="ChoicesList" Margin="0,10,0,0" ItemsSource="{Binding Options}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Frame BorderColor="#dddddd" CornerRadius="5" Padding="10" Margin="0,5,0,5">
                                    <StackLayout Orientation="Horizontal" Spacing="15">
                                        <!-- Entry to edit the choice text -->
                                        <Entry Text="{Binding Text}"
                                               Placeholder="{x:Static local:AppResources.PlaceholderChoiceText}"
                                               FontSize="Medium"
                                               VerticalOptions="Center"
                                               WidthRequest="500" />
                                        <!-- Button to delete the choice -->
                                        <Button Text="{x:Static local:AppResources.Delete}"
                                                FontSize="Small"
                                                BackgroundColor="#E53935"
                                                TextColor="White"
                                                CornerRadius="20"
                                                HeightRequest="30"
                                                WidthRequest="110"
                                                HorizontalOptions="End"
                                                Padding="5"
                                                Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.DeleteOptionCommand}"
                                                CommandParameter="{Binding}" />
                                    </StackLayout>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </Frame>

            <!-- Save Button -->
            <Button Text="{x:Static local:AppResources.Save}"
                    WidthRequest="200"
                    HeightRequest="60"
                    CornerRadius="10"
                    HorizontalOptions="Center"
                    VerticalOptions="Center" />

            <!-- Back Button -->
            <Button Text="{x:Static local:AppResources.Back}"
                    WidthRequest="200"
                    HeightRequest="60"
                    CornerRadius="10"
                    HorizontalOptions="Center"
                    VerticalOptions="Center"
                    Clicked="OnBackButtonClicked">
                <Button.BackgroundColor>
                    <AppThemeBinding Light="#757575" Dark="#616161" />
                </Button.BackgroundColor>
                <Button.TextColor>
                    <AppThemeBinding Light="White" Dark="White" />
                </Button.TextColor>
            </Button>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
